"use strict"

const PostHTML = require("posthtml")
const html =
`
<a href="/something">Somehting</a>
<a href="http://kottans.org">Kottans</a>
`
const attrs = { href: true, target: false, rel: false }
const links = ["a", "area"].map(tag =>
{
  return{tag, attrs}
})

const isAbsolute = RegExp("^(https?)?://")
const plugin = tree => tree
  .match(links, link =>
    {
      let {attrs} = link
      let {href} = attrs
      if(isAbsolute.test(href))
      {
        attrs.target = "_blank"
        attrs.rel = "external"
      }
      return link
    })

PostHTML([plugin])
.process(html)
.then(result =>
  {
    console.log(result.html)
  })
.catch(console.error)